<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElGamal Encryption</title>
</head>
<body>
    <h1>ElGamal Encryption</h1>
    <label for="message">Nhập tin nhắn:</label><br>
    <textarea id="message"></textarea><br>
    <button onclick="encrypt()">Mã hóa</button>
    <button onclick="decrypt()">Giải mã</button><br>
    <label for="ciphertext">Tin nhắn đã mã hóa:</label><br>
    <textarea id="ciphertext" readonly></textarea><br>
    <label for="plaintext">Tin nhắn đã giải mã:</label><br>
    <textarea id="plaintext" readonly></textarea><br>

    <script src="https://kjur.github.io/jsrsasign/jsrsasign-latest-all-min.js"></script>
    <script>
        // Hàm mã hóa
        function encrypt() {
            const message = document.getElementById("message").value;

            // Tạo cặp khóa ElGamal
            const key = new KEYUTIL.getKey("-----BEGIN PUBLIC KEY-----\n" +
                "MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAJ9O2q+KkyTSHKUY1TPenb5H1hXJd6t\n" +
                "Y9dZf0Ro0hQ3CUTvJ47EYwshe0mKOUe9C+ZK4QpNQynX5TbAtfGq90sCAwEAAQ==\n" +
                "-----END PUBLIC KEY-----");

            // Mã hóa tin nhắn
            const ciphertext = KJUR.crypto.Cipher.encrypt(message, key);

            document.getElementById("ciphertext").value = ciphertext;
        }

        // Hàm giải mã
        function decrypt() {
            const ciphertext = document.getElementById("ciphertext").value;

            // Tạo cặp khóa ElGamal
            const key = new RSAKey();

            key.readPublicKeyFromPEMString("-----BEGIN PUBLIC KEY-----\n" +
                "MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAJ9O2q+KkyTSHKUY1TPenb5H1hXJd6t\n" +
                "Y9dZf0Ro0hQ3CUTvJ47EYwshe0mKOUe9C+ZK4QpNQynX5TbAtfGq90sCAwEAAQ==\n" +
                "-----END PUBLIC KEY-----");

            // Giải mã tin nhắn
            const plaintext = KJUR.crypto.Cipher.decrypt(ciphertext, key);

            document.getElementById("plaintext").value = plaintext;
        }
    </script>
</body>
</html>
